# Story 2.4 - Ajouter plusieurs photos Ã  une fiche

## Epic
Epic 2 : CrÃ©ation du catalogue photo

## User Story
**En tant qu'** utilisateur  
**Je veux** ajouter plusieurs photos Ã  une mÃªme fiche  
**Afin de** montrer un objet sous diffÃ©rents angles ou montrer des dÃ©tails

## Contexte
Un meuble peut nÃ©cessiter plusieurs photos : vue d'ensemble, dÃ©tail d'une marque, dÃ©faut Ã  signaler, etc. La premiÃ¨re photo reste la principale (miniature), les autres sont accessibles dans le dÃ©tail.

## PrioritÃ©
**Should** - Utile mais pas bloquant pour le MVP. Une photo par fiche fonctionne pour commencer.

## CritÃ¨res d'Acceptation

- [ ] Sur la page de dÃ©tail d'une fiche, un bouton permet d'ajouter une photo
- [ ] PossibilitÃ© de prendre une photo ou d'importer depuis la galerie
- [ ] Les photos sont affichÃ©es en galerie/carousel sur la page de dÃ©tail
- [ ] La premiÃ¨re photo (position 0) est utilisÃ©e comme miniature dans la galerie
- [ ] L'ordre des photos peut Ãªtre modifiÃ© (drag & drop ou flÃ¨ches)
- [ ] Une photo peut Ãªtre supprimÃ©e (sauf s'il n'en reste qu'une)

## Ã‰lÃ©ments Techniques

### Table photos
```sql
CREATE TABLE photos (
  id SERIAL PRIMARY KEY,
  item_id INT REFERENCES items(id) ON DELETE CASCADE,
  data TEXT NOT NULL,
  position INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW()
);

-- La photo principale
SELECT data FROM photos WHERE item_id = $1 ORDER BY position LIMIT 1;

-- Toutes les photos
SELECT * FROM photos WHERE item_id = $1 ORDER BY position;
```

### API Endpoints
```
POST /api/items/:itemId/photos
Body: { photo: "data:image/jpeg;base64,..." }
â†’ Ajoute une photo Ã  la fiche

DELETE /api/items/:itemId/photos/:photoId
â†’ Supprime une photo (si > 1 photo)

PATCH /api/items/:itemId/photos/reorder
Body: { photoIds: [3, 1, 2] }
â†’ RÃ©ordonne les photos
```

### Affichage Carousel
```jsx
// Carousel simple avec indicateurs
<div className="photo-carousel">
  <img src={photos[currentIndex].data} />
  <div className="indicators">
    {photos.map((_, i) => (
      <span 
        key={i} 
        className={i === currentIndex ? 'active' : ''}
        onClick={() => setCurrentIndex(i)}
      />
    ))}
  </div>
</div>
```

## Maquette SimplifiÃ©e

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        #12 - Buffet         â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                   â”‚    â”‚
â”‚    â”‚      ğŸ“· 1/3       â”‚    â”‚
â”‚    â”‚                   â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â— â—‹ â—‹               â”‚
â”‚                             â”‚
â”‚    [+ Ajouter une photo]    â”‚
â”‚                             â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚    Description...           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## DÃ©pendances
- 2.1, 2.2, 2.3 : La crÃ©ation de fiche avec une photo

## Stories LiÃ©es
- 5.2 : Affichage du dÃ©tail d'une fiche
