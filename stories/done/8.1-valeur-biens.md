# Story 8.1 - Valeur estimée des biens ✅

## Statut : TERMINÉ

## Objectif
Permettre d'indiquer une valeur estimée (en euros) pour chaque objet, et ainsi calculer la valeur totale des biens choisis par chaque membre de la famille.

## Contexte utilisateur
Les parents souhaitent pouvoir estimer la valeur des objets pour :
- Avoir une vue d'ensemble du patrimoine catalogué
- S'assurer d'une répartition équitable entre les enfants
- Identifier les objets de valeur importante

## Implémentation réalisée

### 1. Champ valeur sur la fiche objet
- Champ optionnel "Valeur estimée" en euros
- Format : nombre entier (sans décimales, conformément à la demande utilisateur)
- Affiché sous le titre de l'objet (position plus visible)
- Modifiable par tous les membres de la famille
- Cible tactile de 44px minimum (min-h-11) pour accessibilité seniors
- Couleur verte pour la valeur affichée

### 2. Affichage dans la galerie
- Badge vert en haut à gauche sur la vignette si valeur renseignée
- Format : "150 €" ou "1 k€" pour les montants >= 1000€
- Pas de décimales dans l'affichage

### 3. Page Répartition (/repartition)
- Accessible via bouton "Répartition" dans la galerie
- Vue d'ensemble avec totaux séparés :
  - "Je le veux !" : nombre d'objets et valeur totale
  - "Si personne d'autre" : nombre d'objets et valeur totale (affiché séparément)
- Écart max calculé sur les "Je le veux !" uniquement
- Pour chaque membre :
  - Ligne principale : objets "Je le veux !" avec valeur en vert
  - Ligne secondaire : objets "Si personne d'autre" avec valeur en orange (si présents)
  - Barre de progression basée sur les "Je le veux !"
- Tri par valeur totale décroissante (love + maybe)
- Seuls les objets non-supprimés sont comptés

## Critères d'acceptation

### Saisie de la valeur
- [x] Le champ valeur accepte les nombres positifs (0 autorisé = gratuit/sans valeur)
- [x] Le champ est optionnel (null = valeur inconnue)
- [x] Format d'affichage avec séparateur de milliers français (1 500 €)
- [x] Pas de décimales (nombres entiers uniquement)
- [x] Cible tactile minimum 44px pour le champ de saisie

### Affichage galerie
- [x] Badge valeur visible mais discret sur les vignettes (vert, haut-gauche)
- [x] Ne pas afficher de badge si valeur non renseignée

### Calcul répartition
- [x] Tableau récapitulatif par personne
- [x] Objets "Je le veux !" comptés et affichés en principal
- [x] Objets "Si personne d'autre" comptés et affichés séparément
- [x] Les objets sans valeur sont comptés en nombre mais pas en euros
- [x] Tri par valeur totale décroissante
- [x] Affichage de l'écart max entre membres (sur "Je le veux !")

## Fichiers modifiés
- `shared/schema.ts` : ajout champ `estimatedValue` (real)
- `server/storage.ts` : mise à jour interface et méthodes CRUD
- `server/routes.ts` : endpoint `/api/stats/repartition` avec stats love et maybe
- `client/src/pages/item-detail.tsx` : champ valeur éditable sous le titre
- `client/src/pages/gallery.tsx` : badge valeur, bouton Répartition
- `client/src/pages/repartition.tsx` : page statistiques avec love et maybe séparés
- `client/src/App.tsx` : route `/repartition`

## Décisions prises
- Valeur modifiable par tous (pas de restriction aux parents)
- Pas d'historique des modifications de valeur
- Pas de filtre par valeur dans la galerie (pourra être ajouté plus tard)
- Montants affichés sans décimales pour simplicité
- Champ valeur positionné sous le titre pour meilleure visibilité
- "Si personne d'autre" affiché séparément des "Je le veux !" dans la répartition
