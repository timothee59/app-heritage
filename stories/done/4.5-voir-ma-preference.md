# Story 4.5 - Voir sa prÃ©fÃ©rence actuelle sur chaque fiche

## Epic
Epic 4 : Expression des prÃ©fÃ©rences

## User Story
**En tant qu'** utilisateur  
**Je veux** voir ma prÃ©fÃ©rence actuelle sur chaque fiche  
**Afin de** me rappeler mes choix sans avoir Ã  les deviner

## Contexte
Quand on revient sur une fiche, on doit voir immÃ©diatement quel choix on a fait. C'est aussi utile dans la galerie pour repÃ©rer d'un coup d'Å“il ses coups de cÅ“ur.

## CritÃ¨res d'Acceptation

- [ ] Dans la galerie, un indicateur montre ma prÃ©fÃ©rence sur chaque miniature
- [ ] Sur la page de dÃ©tail, le bouton correspondant Ã  mon choix est visuellement actif
- [ ] Si je n'ai pas encore fait de choix, aucun bouton n'est actif
- [ ] Les indicateurs sont : â¤ï¸ (love), ğŸ¤” (maybe), ğŸ‘‹ (no), rien (pas encore vu)

## Ã‰lÃ©ments Techniques

### API - Inclure ma prÃ©fÃ©rence dans la liste
```
GET /api/items
Headers: { X-User-Id: 123 }
â†’ Retourne [{
    id, number, title, photo,
    myPreference: "love" | "maybe" | "no" | null
  }]
```

### SQL avec prÃ©fÃ©rence
```sql
SELECT 
  i.*,
  p.level as my_preference
FROM items i
LEFT JOIN preferences p ON i.id = p.item_id AND p.user_id = $1
WHERE i.deleted_at IS NULL
ORDER BY i.number;
```

### Indicateur dans la galerie
```jsx
function ItemCard({ item, myPreference }) {
  const indicators = {
    love: 'â¤ï¸',
    maybe: 'ğŸ¤”',
    no: 'ğŸ‘‹',
  };

  return (
    <div className="item-card">
      <img src={item.photo} />
      <span className="item-number">#{item.number}</span>
      {myPreference && (
        <span className="my-preference">
          {indicators[myPreference]}
        </span>
      )}
    </div>
  );
}
```

### Style de l'indicateur
```css
.item-card {
  position: relative;
}

.my-preference {
  position: absolute;
  top: 8px;
  right: 8px;
  font-size: 1.5rem;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
}
```

## Maquette SimplifiÃ©e

```
Galerie avec indicateurs :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ğŸ“·  â¤ï¸â”‚ â”‚ ğŸ“·  ğŸ¤”â”‚        â”‚
â”‚  â”‚  #1   â”‚ â”‚  #2   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ğŸ“·  ğŸ‘‹â”‚ â”‚ ğŸ“·    â”‚â† pas   â”‚
â”‚  â”‚  #3   â”‚ â”‚  #4   â”‚  encoreâ”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜  vu    â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## DÃ©pendances
- 4.1, 4.2, 4.3 : Les prÃ©fÃ©rences doivent pouvoir Ãªtre enregistrÃ©es
- 5.1 : La galerie principale

## Stories LiÃ©es
- 5.4 : Vue "Mes coups de cÅ“ur"
- 5.6 : Vue "Mes fiches Ã  traiter"
