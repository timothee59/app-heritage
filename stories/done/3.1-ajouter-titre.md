# Story 3.1 - Ajouter ou modifier le titre d'une fiche

## Epic
Epic 3 : Enrichissement collaboratif des fiches

## User Story
**En tant qu'** utilisateur  
**Je veux** ajouter ou modifier le titre d'une fiche  
**Afin de** donner un nom parlant à l'objet ("Buffet de la salle à manger")

## Contexte
Le titre est optionnel (le numéro suffit pour identifier), mais utile pour les objets importants ou pour faciliter la recherche. N'importe qui peut ajouter ou modifier le titre - c'est collaboratif.

## Critères d'Acceptation

- [ ] Sur la page de détail, le titre est éditable
- [ ] Si pas de titre, afficher un placeholder "Ajouter un titre..." cliquable
- [ ] Si titre existant, cliquer dessus permet de l'éditer
- [ ] Sauvegarde automatique après quelques secondes d'inactivité ou sur blur
- [ ] Le titre est limité à 100 caractères
- [ ] Le titre apparaît après le numéro dans la galerie et le détail ("#12 - Buffet")
- [ ] Pas de titre = afficher seulement le numéro ("#12")

## Éléments Techniques

### API Endpoint
```
PATCH /api/items/:id
Body: { title: "Buffet de la salle à manger" }
→ Retourne la fiche mise à jour
```

### Base de données
```sql
UPDATE items SET title = $1 WHERE id = $2 RETURNING *;
```

### Composant éditable
```jsx
function EditableTitle({ itemId, initialTitle }) {
  const [title, setTitle] = useState(initialTitle || '');
  const [isEditing, setIsEditing] = useState(false);
  const timeoutRef = useRef(null);

  const handleChange = (e) => {
    const newTitle = e.target.value.slice(0, 100);
    setTitle(newTitle);
    
    // Debounce save
    clearTimeout(timeoutRef.current);
    timeoutRef.current = setTimeout(() => saveTitle(newTitle), 1000);
  };

  const saveTitle = async (value) => {
    await fetch(`/api/items/${itemId}`, {
      method: 'PATCH',
      body: JSON.stringify({ title: value }),
    });
  };

  return isEditing ? (
    <input
      value={title}
      onChange={handleChange}
      onBlur={() => setIsEditing(false)}
      placeholder="Ajouter un titre..."
      autoFocus
    />
  ) : (
    <span onClick={() => setIsEditing(true)}>
      {title || 'Ajouter un titre...'}
    </span>
  );
}
```

## Maquette Simplifiée

```
Sans titre :
┌─────────────────────────────┐
│        #12                  │
│    [Ajouter un titre...]    │
│─────────────────────────────│

Avec titre :
┌─────────────────────────────┐
│        #12                  │
│    Buffet salle à manger    │  ← cliquable pour éditer
│─────────────────────────────│

En édition :
┌─────────────────────────────┐
│        #12                  │
│    ┌────────────────────┐   │
│    │Buffet salle à mang_│   │
│    └────────────────────┘   │
│─────────────────────────────│
```

## Dépendances
- 5.2 : La page de détail d'une fiche

## Stories Liées
- 3.2 : Ajouter/modifier la description (même logique)
