# Story 1.0 - PremiÃ¨re connexion (aucun utilisateur)

## Epic
Epic 1 : Identification simple

## User Story
**En tant que** premier utilisateur de l'application  
**Je veux** pouvoir crÃ©er mon profil directement  
**Afin de** dÃ©marrer l'utilisation sans Ãªtre bloquÃ© par une liste vide

## Contexte
Lors du tout premier lancement de l'application, la base de donnÃ©es est vide. Il n'y a aucun utilisateur dans la liste. On ne peut donc pas "choisir son prÃ©nom" â€” il faut obligatoirement en crÃ©er un. L'interface doit s'adapter Ã  ce cas particulier.

## CritÃ¨res d'Acceptation

- [ ] Au lancement, l'app vÃ©rifie s'il existe des utilisateurs en base
- [ ] Si aucun utilisateur n'existe, afficher directement le formulaire de crÃ©ation
- [ ] Le dropdown de sÃ©lection n'est PAS affichÃ© (inutile si liste vide)
- [ ] L'utilisateur doit saisir son prÃ©nom (2-50 caractÃ¨res)
- [ ] L'utilisateur doit choisir son rÃ´le (parent/enfant)
- [ ] AprÃ¨s crÃ©ation, l'utilisateur est automatiquement connectÃ©
- [ ] Les prochains visiteurs verront le flux normal (story 1.1) avec la liste

## Ã‰lÃ©ments Techniques

### VÃ©rification au dÃ©marrage
```javascript
async function checkFirstLaunch() {
  const response = await fetch('/api/users');
  const users = await response.json();
  
  if (users.length === 0) {
    // Premier lancement â†’ formulaire crÃ©ation
    return { mode: 'create' };
  } else {
    // Utilisateurs existants â†’ Ã©cran de sÃ©lection
    return { mode: 'select', users };
  }
}
```

### API Endpoint
```
GET /api/users
â†’ Retourne [] si aucun utilisateur
â†’ Retourne [{id, name, role}, ...] sinon
```

### Logique du composant
```jsx
function IdentificationScreen() {
  const [mode, setMode] = useState(null); // 'create' | 'select'
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function init() {
      const result = await checkFirstLaunch();
      setMode(result.mode);
      if (result.users) setUsers(result.users);
      setLoading(false);
    }
    init();
  }, []);

  if (loading) return <Spinner />;

  if (mode === 'create') {
    return <CreateUserForm onCreated={handleUserCreated} isFirstUser={true} />;
  }

  return <SelectUserForm users={users} onAddNew={() => setMode('create')} />;
}
```

### Message d'accueil pour le premier utilisateur
```jsx
function CreateUserForm({ isFirstUser }) {
  return (
    <div className="create-user">
      {isFirstUser && (
        <div className="welcome-message">
          <h2>Bienvenue ! ğŸ‘‹</h2>
          <p>Vous Ãªtes le premier Ã  utiliser l'application.</p>
          <p>Commencez par crÃ©er votre profil.</p>
        </div>
      )}
      
      <input 
        placeholder="Votre prÃ©nom"
        // ...
      />
      
      <div className="role-choice">
        <button>ğŸ‘´ Parent</button>
        <button>ğŸ‘¶ Enfant</button>
      </div>
    </div>
  );
}
```

## Maquette SimplifiÃ©e

```
Premier lancement (DB vide) :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚    ğŸ¦ HÃ©ritage PartagÃ©      â”‚
â”‚                             â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                             â”‚
â”‚    Bienvenue ! ğŸ‘‹           â”‚
â”‚                             â”‚
â”‚    Vous Ãªtes le premier     â”‚
â”‚    Ã  utiliser l'app.        â”‚
â”‚                             â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                             â”‚
â”‚    Votre prÃ©nom :           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                     â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚
â”‚    Vous Ãªtes...             â”‚
â”‚                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚  ğŸ‘´   â”‚  â”‚  ğŸ‘¶   â”‚     â”‚
â”‚    â”‚Parent â”‚  â”‚Enfant â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚
â”‚        [Commencer]          â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Lancements suivants (users existent) :
â†’ Voir story 1.1 (Ã©cran avec dropdown)
```

## Flux complet

```
App lancÃ©e
    â”‚
    â–¼
GET /api/users
    â”‚
    â”œâ”€â”€ [] vide â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Formulaire crÃ©ation (cette story)
    â”‚                              â”‚
    â”‚                              â–¼
    â”‚                       POST /api/users
    â”‚                              â”‚
    â”‚                              â–¼
    â”‚                       ConnectÃ© â†’ Galerie
    â”‚
    â””â”€â”€ [{...}] existants â”€â”€â–º Ã‰cran sÃ©lection (story 1.1)
```

## DÃ©pendances
- Aucune (c'est la premiÃ¨re story Ã  implÃ©menter)

## Stories LiÃ©es
- 1.1 : Choisir son prÃ©nom (flux normal quand users existent)
- 1.2 : Ajouter son prÃ©nom (rÃ©utilise le mÃªme formulaire)
- 1.3 : Indiquer son rÃ´le (intÃ©grÃ© dans ce flux)
